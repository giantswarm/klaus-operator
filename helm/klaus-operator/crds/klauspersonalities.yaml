apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: klauspersonalities.klaus.giantswarm.io
  annotations:
    controller-gen.kubebuilder.io/version: (devel)
spec:
  group: klaus.giantswarm.io
  names:
    kind: KlausPersonality
    listKind: KlausPersonalityList
    plural: klauspersonalities
    singular: klauspersonality
    shortNames:
      - kp
  scope: Namespaced
  versions:
    - name: v1alpha1
      served: true
      storage: true
      subresources:
        status: {}
      additionalPrinterColumns:
        - name: Description
          type: string
          jsonPath: .spec.description
        - name: Age
          type: date
          jsonPath: .metadata.creationTimestamp
      schema:
        openAPIV3Schema:
          description: >-
            KlausPersonality defines a reusable template for KlausInstance
            configuration. Instances can reference a personality via
            personalityRef to inherit its defaults. Full implementation in #3.
          type: object
          properties:
            apiVersion:
              type: string
            kind:
              type: string
            metadata:
              type: object
            spec:
              description: KlausPersonalitySpec defines the template configuration.
              type: object
              properties:
                description:
                  description: Human-readable description of this personality.
                  type: string
                claude:
                  description: Claude Code agent configuration defaults.
                  type: object
                  x-kubernetes-preserve-unknown-fields: true
                plugins:
                  description: Default OCI plugin references.
                  type: array
                  items:
                    type: object
                    required:
                      - repository
                    properties:
                      repository:
                        type: string
                      tag:
                        type: string
                      digest:
                        type: string
                pluginDirs:
                  description: Default additional plugin directory paths.
                  type: array
                  items:
                    type: string
                mcpServers:
                  description: Default KlausMCPServer references.
                  type: array
                  items:
                    type: object
                    required:
                      - name
                    properties:
                      name:
                        type: string
                skills:
                  description: Default inline skill configurations.
                  type: object
                  x-kubernetes-preserve-unknown-fields: true
                agentFiles:
                  description: Default inline agent file definitions.
                  type: object
                  x-kubernetes-preserve-unknown-fields: true
                hooks:
                  description: Default lifecycle hooks.
                  type: object
                  x-kubernetes-preserve-unknown-fields: true
                hookScripts:
                  description: Default executable hook scripts.
                  type: object
                  additionalProperties:
                    type: string
                addDirs:
                  description: Default additional directories.
                  type: array
                  items:
                    type: string
                resources:
                  description: Default compute resource requirements.
                  type: object
                  properties:
                    limits:
                      type: object
                      additionalProperties:
                        anyOf:
                          - type: integer
                          - type: string
                        x-kubernetes-int-or-string: true
                    requests:
                      type: object
                      additionalProperties:
                        anyOf:
                          - type: integer
                          - type: string
                        x-kubernetes-int-or-string: true
                telemetry:
                  description: Default telemetry configuration.
                  type: object
                  x-kubernetes-preserve-unknown-fields: true
            status:
              description: KlausPersonalityStatus defines the observed state.
              type: object
              properties:
                instanceCount:
                  description: Number of instances using this personality.
                  type: integer
